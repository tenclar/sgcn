<?xml version="1.0" encoding="UTF-8"?>
<p:tab title="Cursos" id="cursos"  >
            <p:fieldset legend="Participação em Cursos" style=" margin: 0 auto; "   >

                <h:panelGrid columns="2" id="selRadioCursos">
                    <h:outputLabel  value="Possui cursos? " styleClass="titulos" />
                    <h:selectOneRadio id="cidcursos" value="#{cidadaoBean.cidadao.curso}"   >
                        <f:selectItem itemValue="false" itemLabel="Não" />
                        <f:selectItem itemValue="true" itemLabel="Sim"  />                            
                        <p:ajax update="panelCursos"  listener="#{cidadaoBean.handleSelectItemCurso}" />
                    </h:selectOneRadio>
                </h:panelGrid>

                <p:panel id="panelCursos"  binding="#{cidadaoBean.panelCursos}"  visible="#{cidadaoBean.cidadao.curso}"   >
                    <h:panelGrid id="insPanelCursos" columns="4" >
                        <h:outputLabel value=" " />
                        <h:panelGrid columns="2">                                        
                            <h:outputLabel value="Curso:" />                                        
                            <p:message for="cidlistacursos" display="icon"  />                                        
                        </h:panelGrid>
                        <h:panelGrid columns="2">
                            <h:outputLabel value= "Horas: " /><p:message for="cidhoras" display="icon" />                                        
                        </h:panelGrid>                                     

                        <h:outputLabel value=" " />
                        <p:commandButton value="+" oncomplete="dlgCurso.show()" process="@this" action="#{cursoBean.newCurso}" update=":frmcadcurso:panelCursoInsert" /> 
                        <p:selectOneMenu id="cidlistacursos" 
                                         filter="true" filterMatchMode="startsWith"
                                         value="#{cidadaoBean.cursos.curso}" 
                                         converter="IndexedConverter" 
                                         required="true" label="Lista de Curso"  >
                            <f:selectItem  itemLabel="selecione" noSelectionOption="true" />
                            <f:selectItems value="#{cidadaoBean.selectItemsCurso}" />
                        </p:selectOneMenu>

                        <p:inputText id="cidhoras" value="#{cidadaoBean.cursos.hora}" size="5" rendered="true" label="Carga Horária" onkeypress="mascara(this, soNumeros)" >
                            <f:validateLongRange minimum="1" maximum="99999" />
                        </p:inputText>

                        <p:commandButton value="Inserir" process="panelCursos" update="dtCursos insPanelCursos :messages" action="#{cidadaoBean.addCurso}" />

                    </h:panelGrid>                               

                    <p:outputPanel id="dtCursos" >
                        <!--                            <p:message for="ihCursos"  showDetail="true"  /> 
                                                    <h:inputHidden id="ihCursos" value="# {cidadaoBean.cidadao.cursos.size()}" rendered="true" label="lista Cursos" validatorMessage="$ {msg.nenhumitem}"  >
                                                        <f:validateLongRange minimum="1" />
                                                    </h:inputHidden> -->
                        <p:dataTable   value="#{cidadaoBean.cidadao.cursos}" var="dados" 
                                       rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row'}" rowIndexVar="rowIx">

                            <p:column  headerText="Curso" >                                                     

                                <h:outputText value="#{dados.curso.nome}" />
                            </p:column>
                            <p:column  headerText="Carga" style="width:100px" >                                                                      

                                <h:outputText value="#{dados.hora}"  />
                            </p:column>
                            <p:column style="width: 80px;text-align: center" >
                                <f:facet name="header">
                                    <h:outputText value="ações"/>
                                </f:facet>                                        
                                <p:commandButton icon="ui-icon-close"  process="@this"  update=":frmCid:tabView:tabViewCarac:dtCursos"  >

                                    <p:collector value="#{dados}" unique="true" removeFrom="#{cidadaoBean.listaCursos}"  />
                                </p:commandButton>
                            </p:column>

                        </p:dataTable>
                    </p:outputPanel>

                </p:panel>

            </p:fieldset>
            <h:panelGroup >
                <p:commandButton value="voltar" immediate="true" action="#{cidadaoBean.salva}" update="tabViewCarac"  oncomplete="tabViewCarac.select(0);" />                               
                <p:commandButton id="btproxcurso" value="próximo" process="@this, selRadioCursos" update="tabViewCarac dtCursos :messages" action="#{cidadaoBean.salva}"  oncomplete="tabViewCarac.select(2);" />                                                  
            </h:panelGroup> 
        </p:tab>
        <p:tab title="Equipamentos" id="equip" >
            <p:fieldset legend="Equipamentos">
                <h:panelGrid columns="2" id="selRadioEquip">
                    <h:outputLabel  value="Possui equipamentos ? " styleClass="titulos" />
                    <h:selectOneRadio id="cidequipamentos" value="#{cidadaoBean.cidadao.equipamento}"  >
                        <f:selectItem itemValue="false" itemLabel="Não" />
                        <f:selectItem itemValue="true" itemLabel="Sim"  />                            
                        <p:ajax update="panelEquip"  listener="#{cidadaoBean.handleSelectItemEquip}" />
                    </h:selectOneRadio>
                </h:panelGrid>  
                <p:panel id="panelEquip" binding="#{cidadaoBean.panelEquip}"  visible="#{cidadaoBean.cidadao.equipamento}" >
                    <h:panelGrid id="insPanelEquipamento" columns="4"  >

                        <h:panelGrid columns="2">                                        
                            <h:outputLabel value="Equipamento: " />                                        
                            <p:message for="planolistaEquipamento" display="icon"  />                                        
                        </h:panelGrid>

                        <h:panelGrid columns="2">
                            <h:outputLabel value= "Estado: " />
                            <p:message for="planoEstadoEquip" display="icon" />                                        
                        </h:panelGrid>                                    


                        <h:outputLabel value=" " />
                        <h:outputLabel value=" " />

                        <p:selectOneMenu id="planolistaEquipamento"  filter="true"
                                         filterMatchMode="startsWith" style="width: 100px;"
                                         value="#{cidadaoBean.equipamentosproprios.equipamento}" 
                                         converter="IndexedConverter" required="true"   label="Equipamento"  >
                            <f:selectItem  itemLabel="selecione" noSelectionOption="true" />
                            <f:selectItems value="#{equipamentoBean.selectItemsEquipamentos}" />
                        </p:selectOneMenu>
                        <h:selectOneMenu id="planoEstadoEquip" 
                                         value="#{cidadaoBean.equipamentosproprios.estado}"                                          
                                         required="true" label="Estado"  >
                            <f:selectItem  itemLabel="selecione" noSelectionOption="true" />
                            <f:selectItem  itemLabel="ÓTIMO" itemValue="OTIMO"  />
                            <f:selectItem  itemLabel="BOM" itemValue="BOM"  />
                            <f:selectItem  itemLabel="REGULAR" itemValue="REGULAR"  />
                            <f:selectItem  itemLabel="INSERVÍVEL" itemValue="INSERVIVEL"  />
                        </h:selectOneMenu>

                        <p:commandButton value="Inserir" process="panelEquip" update="insPanelEquipamento dtEquipPro  :messages" action="#{cidadaoBean.addEquipPro}" />
                        <p:commandButton value="+" oncomplete="dlgEquipamento.show()" process="@this" action="#{equipamentoBean.newEquipamento}" update=":frmEquipamento:panelEquipamentoInsert" /> 
                    </h:panelGrid>                                                      
                    <p:outputPanel id="dtEquipPro" >
                        <!--                            <p:message for="ihEquipPro"  showDetail="true"  /> 
                                                    <h:inputHidden id="ihEquipPro" value="# {cidadaoBean.cidadao.equipamentosproprios.size()}" rendered="true" label="lista Equipamentos" validatorMessage="$ {msg.nenhumitem}"  >
                                                        <f:validateLongRange minimum="1" />
                                                    </h:inputHidden> -->
                        <p:dataTable  value="#{cidadaoBean.cidadao.equipamentosproprios}" var="item" emptyMessage="${msg.lista_vasia}" 
                                      rowStyleClass="#{empty rowIx or rowIx mod 2 ne 0 ? 'even-row' : 'odd-row'}" rowIndexVar="rowIx">
                            <f:facet name="header">
                                <h:outputText value="Lista de Equipamentos Próprios" />
                            </f:facet>
                            <p:column  headerText="Equipamento" >                                               

                                <h:outputText value="#{item.equipamento.nome}" />
                            </p:column>
                            <p:column  headerText="Estado" >                                                                     
                                <h:outputText value="#{item.estado}" />
                            </p:column>
                            <!--                                    <p:column  headerText="uso" >                                                                      
                                                                    <h:outputText value="# {item.tempo}" />
                                                                </p:column>-->
                            <p:column style="width: 80px;text-align: center" >
                                <f:facet name="header">
                                    <h:outputText value="ações"/>
                                </f:facet>                                        
                                <p:commandButton icon="ui-icon-close"  process="@this"  update=":frmCid:tabView:tabViewCarac:dtEquipPro"  >
                                    <p:collector value="#{item}" unique="true" removeFrom="#{cidadaoBean.cidadao.equipamentosproprios}"  />
                                </p:commandButton>
                            </p:column>

                        </p:dataTable>
                    </p:outputPanel>  

                </p:panel>
            </p:fieldset>  
            <h:panelGroup >
                <p:commandButton value="voltar" immediate="true" action="#{cidadaoBean.salva}" update="tabViewCarac"   oncomplete="tabViewCarac.select(1);" />                        
                <p:commandButton value="próximo" process="@this selRadioEquip" update="tabViewCarac" action="#{cidadaoBean.salva}"  oncomplete="tabViewCarac.select(3);" />                                                  
            </h:panelGroup> 
        </p:tab>    
